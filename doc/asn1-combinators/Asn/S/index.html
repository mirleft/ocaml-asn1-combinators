<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>S (asn1-combinators.Asn.S)</title><meta charset="utf-8"/><link rel="stylesheet" href="../../../odoc.support/odoc.css"/><meta name="generator" content="odoc 2.4.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">asn1-combinators</a> &#x00BB; <a href="../index.html">Asn</a> &#x00BB; S</nav><header class="odoc-preamble"><h1>Module <code><span>Asn.S</span></code></h1><p>ASN.1 Abstract Syntax.</p><p>This module is the OCaml term-level analogue of ASN.1's surface notation.</p><p>It provides a ground type <a href="#type-t" title="S.t"><code>'a t</code></a> representing typed abstract syntax, a suite of primitives that correspond to ASN.1 primitives, and a suite of combinators that correspond to the combining structures of ASN.1.</p><p>ASN.1 naming and modules are not supported; these are provided by the host language instead.</p></header><nav class="odoc-toc"><ul><li><a href="#asn.1-abstract-syntax">ASN.1 Abstract Syntax</a></li><li><a href="#basic-combinators">Basic combinators</a></li><li><a href="#tags">Tags</a></li><li><a href="#combining-constructs">Combining constructs</a></li><li><a href="#primitives">Primitives</a><ul><li><a href="#string-primitives">String primitives</a></li><li><a href="#additional-primitives">Additional primitives</a></li></ul></li><li><a href="#errors">Errors</a></li></ul></nav><div class="odoc-content"><h2 id="asn.1-abstract-syntax"><a href="#asn.1-abstract-syntax" class="anchor"></a>ASN.1 Abstract Syntax</h2><div class="odoc-spec"><div class="spec type anchored" id="type-t"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span class="keyword">nonrec</span> <span>'a t</span></span><span> = <span><span class="type-var">'a</span> <a href="../index.html#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>'a t</code> denotes a particular structure of data, irrespective of any encoding, that is represented by <code>'a</code> in OCaml.</p></div></div><h2 id="basic-combinators"><a href="#basic-combinators" class="anchor"></a>Basic combinators</h2><div class="odoc-spec"><div class="spec value anchored" id="val-fix"><a href="#val-fix" class="anchor"></a><code><span><span class="keyword">val</span> fix : <span><span>(<span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>fix fasn</code> is the fixpoint, allowing <code>fasn</code> to construct a syntax that refers to itself.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-map"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span class="optlabel">?random</span>:<span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>map ?random f g asn</code> creates a derived syntax that encodes and decodes like <code>asn</code>, but uses <code>f</code> to project and <code>g</code> to inject.</p><p><code>~random</code> is a function that generates random samples of <code>'b</code>. Defaults to <code>f a</code> where <code>a</code> is a random <code>'a</code>.</p></div></div><h2 id="tags"><a href="#tags" class="anchor"></a>Tags</h2><div class="odoc-spec"><div class="spec type anchored" id="type-cls"><a href="#type-cls" class="anchor"></a><code><span><span class="keyword">type</span> cls</span><span> = </span><span>[ </span></code><ol><li id="type-cls.Universal" class="def variant constructor anchored"><a href="#type-cls.Universal" class="anchor"></a><code><span>| </span><span>`Universal</span></code></li><li id="type-cls.Application" class="def variant constructor anchored"><a href="#type-cls.Application" class="anchor"></a><code><span>| </span><span>`Application</span></code></li><li id="type-cls.Private" class="def variant constructor anchored"><a href="#type-cls.Private" class="anchor"></a><code><span>| </span><span>`Private</span></code></li></ol><code><span> ]</span></code></div><div class="spec-doc"><p>ASN.1 tag CLASS.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-implicit"><a href="#val-implicit" class="anchor"></a><code><span><span class="keyword">val</span> implicit : <span><span class="optlabel">?cls</span>:<a href="#type-cls">cls</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>implicit ?cls n asn</code> is the ASN.1 <code>IMPLICIT</code> construct, changing the tag of <code>asn</code> to <code>(cls, n)</code>.</p><p><code>n</code> is the tag value.</p><p><code>~cls</code> is the class. Defaults to <code>CONTEXT SPECIFIC</code>.</p><p><b>Note</b> <code>implicit</code> implicitly becomes <code>explicit</code> when applied to nodes that cannot be made <code>IMPLICIT</code>, like <code>CHOICE</code>. This is consistent with X.608 (see <code>31.2.7</code>) in case of a bare tag, and with the common practice in case of a tag marked as <code>IMPLICIT</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-explicit"><a href="#val-explicit" class="anchor"></a><code><span><span class="keyword">val</span> explicit : <span><span class="optlabel">?cls</span>:<a href="#type-cls">cls</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>explicit ?cls n asn</code> is the ASN.1 <code>EXPLICIT</code> construct, changing the tag of <code>asn</code> to <code>(cls, n)</code>.</p><p><code>n</code> is the tag value.</p><p><code>~cls</code> is the class. Defaults to <code>CONTEXT SPECIFIC</code>.</p></div></div><h2 id="combining-constructs"><a href="#combining-constructs" class="anchor"></a>Combining constructs</h2><p>These look like</p><pre class="language-ocaml"><code>sequence @@
   (required ~label:&quot;l1&quot; asn1)
 @ (optional ~label:&quot;l2&quot; asn2)
 @ (required ~label:&quot;l3&quot; asn3)
-@ (optional ~label:&quot;l4&quot; asn4)</code></pre><p>or</p><pre class="language-ocaml"><code>choice3 asn1 asn2 asn3</code></pre><div class="odoc-spec"><div class="spec type anchored" id="type-element"><a href="#type-element" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a element</span></span></code></div><div class="spec-doc"><p>An <code>element</code> is a single slot in a <a href="#val-sequence" title="sequence"><code>sequence</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-required"><a href="#val-required" class="anchor"></a><code><span><span class="keyword">val</span> required : <span><span class="optlabel">?label</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-element">element</a></span></span></code></div><div class="spec-doc"><p><code>required ?label asn</code> is a regular sequence element.</p><p><code>~label</code> is the name of the element.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-optional"><a href="#val-optional" class="anchor"></a><code><span><span class="keyword">val</span> optional : <span><span class="optlabel">?label</span>:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> option</span> <a href="#type-element">element</a></span></span></code></div><div class="spec-doc"><p><code>optional ?label asn</code> is a sequence element marked with the ASN.1 <code>OPTIONAL</code> keyword.</p><p><code>~label</code> is the name of the element.</p></div></div><div class="odoc-spec"><div class="spec type anchored" id="type-sequence"><a href="#type-sequence" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a sequence</span></span></code></div><div class="spec-doc"><p>A <code>sequence</code> is the body of a multi-field ASN.1 construct, like <code>SEQUENCE</code> and <code>SET</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-single"><a href="#val-single" class="anchor"></a><code><span><span class="keyword">val</span> single : <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-sequence">sequence</a></span></span></code></div><div class="spec-doc"><p><code>single e</code> is the singleton sequence containing just <code>e</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(@)"><a href="#val-(@)" class="anchor"></a><code><span><span class="keyword">val</span> (@) : <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-sequence">sequence</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-sequence">sequence</a></span></span></code></div><div class="spec-doc"><p><code>e @ seq</code> extends <code>seq</code> by prepending <code>e</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-(-@)"><a href="#val-(-@)" class="anchor"></a><code><span><span class="keyword">val</span> (-@) : <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-sequence">sequence</a></span></span></code></div><div class="spec-doc"><p><code>e -@ e1</code> is <code>e @ single e1</code></p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sequence"><a href="#val-sequence" class="anchor"></a><code><span><span class="keyword">val</span> sequence : <span><span><span class="type-var">'a</span> <a href="#type-sequence">sequence</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>sequence seq</code> is the ASN.1 <code>SEQUENCE</code> construct, with the body <code>seq</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sequence_of"><a href="#val-sequence_of" class="anchor"></a><code><span><span class="keyword">val</span> sequence_of : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>sequence_of</code> is the ASN.1 <code>SEQUENCE OF</code> construct.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sequence2"><a href="#val-sequence2" class="anchor"></a><code><span><span class="keyword">val</span> sequence2 : <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>sequence2 e1 e2</code> is <code>sequence (e1 -@ e2)</code>. Other <code>sequenceN</code> functions are analogous.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sequence3"><a href="#val-sequence3" class="anchor"></a><code><span><span class="keyword">val</span> sequence3 : <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sequence4"><a href="#val-sequence4" class="anchor"></a><code><span><span class="keyword">val</span> sequence4 : 
  <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sequence5"><a href="#val-sequence5" class="anchor"></a><code><span><span class="keyword">val</span> sequence5 : 
  <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span> * <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sequence6"><a href="#val-sequence6" class="anchor"></a><code><span><span class="keyword">val</span> sequence6 : 
  <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'f</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span> * <span class="type-var">'e</span> * <span class="type-var">'f</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span><span><span class="type-var">'a</span> <a href="#type-sequence">sequence</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>seq seq</code> is the ASN.1 <code>SET</code> construct, with the body <code>seq</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set_of"><a href="#val-set_of" class="anchor"></a><code><span><span class="keyword">val</span> set_of : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>set_of asn</code> is the ASN.1 <code>SET OF</code> construct.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set2"><a href="#val-set2" class="anchor"></a><code><span><span class="keyword">val</span> set2 : <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span>)</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>set2 e1 e2</code> is <code>set (e1 -@ e2)</code>. Other <code>setN</code> functions are analogous.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set3"><a href="#val-set3" class="anchor"></a><code><span><span class="keyword">val</span> set3 : <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set4"><a href="#val-set4" class="anchor"></a><code><span><span class="keyword">val</span> set4 : 
  <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set5"><a href="#val-set5" class="anchor"></a><code><span><span class="keyword">val</span> set5 : 
  <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span> * <span class="type-var">'e</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-set6"><a href="#val-set6" class="anchor"></a><code><span><span class="keyword">val</span> set6 : 
  <span><span><span class="type-var">'a</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'f</span> <a href="#type-element">element</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span class="type-var">'a</span> * <span class="type-var">'b</span> * <span class="type-var">'c</span> * <span class="type-var">'d</span> * <span class="type-var">'e</span> * <span class="type-var">'f</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-choice2"><a href="#val-choice2" class="anchor"></a><code><span><span class="keyword">val</span> choice2 : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ <span>`C1 of <span class="type-var">'a</span></span> <span><span>| `C2</span> of <span class="type-var">'b</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>choice2 asn1 asn2</code> is the ASN.1 <code>CHOICE</code> construct, choosing between <code>asn1</code> and <code>asn2</code>. Other <code>choiceN</code> functions are analogous.</p><p>Larger <code>CHOICE</code> can be obtained by nesting <code>choice</code> variants.</p><p><b>Note</b> <code>CHOICE</code> containing elements with the same tag yields an illegal syntax. This will be detected by <a href="../index.html#val-codec"><code>codec</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-choice3"><a href="#val-choice3" class="anchor"></a><code><span><span class="keyword">val</span> choice3 : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ <span>`C1 of <span class="type-var">'a</span></span> <span><span>| `C2</span> of <span class="type-var">'b</span></span> <span><span>| `C3</span> of <span class="type-var">'c</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-choice4"><a href="#val-choice4" class="anchor"></a><code><span><span class="keyword">val</span> choice4 : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ <span>`C1 of <span class="type-var">'a</span></span> <span><span>| `C2</span> of <span class="type-var">'b</span></span> <span><span>| `C3</span> of <span class="type-var">'c</span></span> <span><span>| `C4</span> of <span class="type-var">'d</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-choice5"><a href="#val-choice5" class="anchor"></a><code><span><span class="keyword">val</span> choice5 : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ <span>`C1 of <span class="type-var">'a</span></span> <span><span>| `C2</span> of <span class="type-var">'b</span></span> <span><span>| `C3</span> of <span class="type-var">'c</span></span> <span><span>| `C4</span> of <span class="type-var">'d</span></span> <span><span>| `C5</span> of <span class="type-var">'e</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-choice6"><a href="#val-choice6" class="anchor"></a><code><span><span class="keyword">val</span> choice6 : 
  <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'b</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'c</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'d</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'e</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span class="type-var">'f</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ <span>`C1 of <span class="type-var">'a</span></span> <span><span>| `C2</span> of <span class="type-var">'b</span></span> <span><span>| `C3</span> of <span class="type-var">'c</span></span> <span><span>| `C4</span> of <span class="type-var">'d</span></span> <span><span>| `C5</span> of <span class="type-var">'e</span></span> <span><span>| `C6</span> of <span class="type-var">'f</span></span> ]</span> <a href="#type-t">t</a></span></span></code></div></div><h2 id="primitives"><a href="#primitives" class="anchor"></a>Primitives</h2><div class="odoc-spec"><div class="spec value anchored" id="val-bool"><a href="#val-bool" class="anchor"></a><code><span><span class="keyword">val</span> bool : <span>bool <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bool</code> is ASN.1 <code>BOOLEAN</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-integer"><a href="#val-integer" class="anchor"></a><code><span><span class="keyword">val</span> integer : <span>string <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>integer</code> is ASN.1 <code>INTEGER</code>. The representation is a <code>string</code>. Be aware these are two's complement signed integers, in order to encode a positive number where the first bit is set (i.e. 128 = <code>0x80</code>), you have to prepend a 0 byte: <code>0x00 0x80</code>. Otherwise it (<code>0x80</code>) will be decoded as -128. See <a href="#val-unsigned_integer"><code>unsigned_integer</code></a> for automated two's complement transformations.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bit_string"><a href="#val-bit_string" class="anchor"></a><code><span><span class="keyword">val</span> bit_string : <span><span>bool array</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bit_string</code> is ASN.1 <code>BIT STRING</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bit_string_octets"><a href="#val-bit_string_octets" class="anchor"></a><code><span><span class="keyword">val</span> bit_string_octets : <span>string <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bit_string_octets</code> is ASN.1 <code>BIT STRING</code>, represented as <code>string</code>, and padded with 0-bits up to the next full octet.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-octet_string"><a href="#val-octet_string" class="anchor"></a><code><span><span class="keyword">val</span> octet_string : <span>string <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>octet_string</code> is ASN.1 <code>OCTET STRING</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-null"><a href="#val-null" class="anchor"></a><code><span><span class="keyword">val</span> null : <span>unit <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>null</code> is ASN.1 <code>NULL</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-oid"><a href="#val-oid" class="anchor"></a><code><span><span class="keyword">val</span> oid : <span><a href="../index.html#type-oid">oid</a> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>oid</code> is ASN.1 <code>OBJECT IDENTIFIER</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-enumerated"><a href="#val-enumerated" class="anchor"></a><code><span><span class="keyword">val</span> enumerated : <span><span>(<span>int <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int)</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>enumerated f g</code> is ASN.1 <code>ENUMERATED</code>, with <code>f</code> projecting from, and <code>g</code> injecting into an <code>int</code>.</p><p>The full <code>INTEGER</code> range is <i>not</i> supported.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-generalized_time"><a href="#val-generalized_time" class="anchor"></a><code><span><span class="keyword">val</span> generalized_time : <span><span class="xref-unresolved">Ptime</span>.t <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>generalized_time</code> is ASN.1 <code>GeneralizedTime</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-utc_time"><a href="#val-utc_time" class="anchor"></a><code><span><span class="keyword">val</span> utc_time : <span><span class="xref-unresolved">Ptime</span>.t <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>utc_time</code> is ASN.1 <code>UTCTime</code>.</p><p>Representable years are 1950–2049.</p></div></div><h3 id="string-primitives"><a href="#string-primitives" class="anchor"></a>String primitives</h3><p>Various ASN.1 stringy types.</p><p><b>Note</b> Presently, no conversion or validation is performed on strings. They differ only in tags.</p><div class="odoc-spec"><div class="spec value anchored" id="val-utf8_string"><a href="#val-utf8_string" class="anchor"></a><code><span><span class="keyword">val</span> utf8_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-numeric_string"><a href="#val-numeric_string" class="anchor"></a><code><span><span class="keyword">val</span> numeric_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-printable_string"><a href="#val-printable_string" class="anchor"></a><code><span><span class="keyword">val</span> printable_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-teletex_string"><a href="#val-teletex_string" class="anchor"></a><code><span><span class="keyword">val</span> teletex_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-videotex_string"><a href="#val-videotex_string" class="anchor"></a><code><span><span class="keyword">val</span> videotex_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-ia5_string"><a href="#val-ia5_string" class="anchor"></a><code><span><span class="keyword">val</span> ia5_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-graphic_string"><a href="#val-graphic_string" class="anchor"></a><code><span><span class="keyword">val</span> graphic_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-visible_string"><a href="#val-visible_string" class="anchor"></a><code><span><span class="keyword">val</span> visible_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-general_string"><a href="#val-general_string" class="anchor"></a><code><span><span class="keyword">val</span> general_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-universal_string"><a href="#val-universal_string" class="anchor"></a><code><span><span class="keyword">val</span> universal_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bmp_string"><a href="#val-bmp_string" class="anchor"></a><code><span><span class="keyword">val</span> bmp_string : <span>string <a href="#type-t">t</a></span></span></code></div></div><h3 id="additional-primitives"><a href="#additional-primitives" class="anchor"></a>Additional primitives</h3><div class="odoc-spec"><div class="spec value anchored" id="val-int"><a href="#val-int" class="anchor"></a><code><span><span class="keyword">val</span> int : <span>int <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>int</code> is ASN.1 <code>INTEGER</code>, projected into an OCaml <code>int</code>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-unsigned_integer"><a href="#val-unsigned_integer" class="anchor"></a><code><span><span class="keyword">val</span> unsigned_integer : <span>string <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>unsigned_integer</code> is ASN.1 <code>INTEGER</code>, where the necessary two's complement transformations are already applied. That is, it represents unsigned integers encoded as ASN.1 (signed) <code>INTEGER</code>s. Negative ASN.1 <code>INTEGER</code>s are rejected with a parse error.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-bit_string_flags"><a href="#val-bit_string_flags" class="anchor"></a><code><span><span class="keyword">val</span> bit_string_flags : <span><span><span>(int * <span class="type-var">'a</span>)</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> list</span> <a href="#type-t">t</a></span></span></code></div><div class="spec-doc"><p><code>bit_string_flags xs</code> is ASN.1 <code>BIT STRING</code>, represented as a collection of values.</p><p><code>xs</code> is a list of <code>(bit, x)</code>, where bit <code>bit</code> denotes the presence of <code>x</code>.</p></div></div><h2 id="errors"><a href="#errors" class="anchor"></a>Errors</h2><div class="odoc-spec"><div class="spec value anchored" id="val-error"><a href="#val-error" class="anchor"></a><code><span><span class="keyword">val</span> error : <span><span>[ <span>`Parse of string</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>error err</code> aborts parsing with the <a href="#val-error" title="error"><code>error</code></a> <code>err</code>.</p><p>Aborting the parse is useful, for example, in the <code>f</code> argument to <a href="#val-map" title="map"><code>map</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-parse_error"><a href="#val-parse_error" class="anchor"></a><code><span><span class="keyword">val</span> parse_error : <span><span><span>(<span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit, <span class="type-var">'b</span>)</span> <span class="xref-unresolved">Stdlib</span>.format4</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>parse_error fmt ...</code> aborts parsing with the message produced by using <code>fmt</code> to format arguments <code>...</code>.</p></div></div></div></body></html>
